# Copyright (c) 2025 Infineon Technologies AG,
# or an affiliate of Infineon Technologies AG.
#
# SPDX-License-Identifier: Apache-2.0

description: |
  Infineon SAR ADC

  Successive Approximation Register (SAR) ADC peripheral found in
  Infineon devices. The IP block is version-specific, indicated
  by the infineon,version property which corresponds to
  CY_IP_M0S8PASS4A_SAR_VERSION in the PDL headers.

compatible: "infineon,sar-adc"

include:
  - name: adc-controller.yaml
  - name: pinctrl-device.yaml

properties:
  reg:
    required: true
    description: Base address of the SAR ADC registers

  interrupts:
    required: true
    description: Interrupt configuration for the SAR ADC

  infineon,version:
    type: int
    required: true
    enum: [2, 3]
    description: |
      SAR ADC IP block version. Corresponds to CY_IP_M0S8PASS4A_SAR_VERSION
      in the PDL. Different versions have varying capabilities (e.g., v2/v3
      have limited differential support, v4+ has full differential addressing).

  clocks:
    required: true
    description: Clock divider phandle for the ADC peripheral.

  "#io-channel-cells":
    const: 1
    description: Number of cells in an io-channel specifier

  vref-src:
    type: string
    default: "internal"
    enum:
      - "internal"
      - "vdda"
      - "vdda_by_2"
      - "external"
    description: |
      Selects which voltage reference to use for the ADC.
      "internal": Internal Bandgap (1.2V)
      "vdda": VDDA
      "vdda_by_2": VDDA / 2
      "external": External Ref pin

  vref-mv:
    type: int
    default: 1200
    description: |
      Reference voltage in millivolts.
      For "internal" source, this is typically 1200.
      For "vdda" or "external", this should match the actual voltage applied.

  clk-dst:
    type: int
    required: true
    description: Peripheral clock destination for the ADC.

io-channel-cells:
  - input

child-binding:
  description: |
    ADC channel configuration

  properties:
    gpio-port:
      type: int
      description: |
        GPIO port number for the ADC input pin. Required for SARMUX pins
        to configure GPIO drive mode. If not specified, defaults to port 2
        for SARMUX pins 0-7.

    gpio-pin:
      type: int
      description: |
        GPIO pin number within the port for the ADC input pin. Required for
        SARMUX pins to configure GPIO drive mode. This should match the pin
        number in the pinctrl configuration.

    gpio-port-negative:
      type: int
      description: |
        GPIO port number for the negative ADC input pin (differential mode only).
        If not specified, defaults to port 2 for SARMUX pins.

    gpio-pin-negative:
      type: int
      description: |
        GPIO pin number for the negative ADC input pin (differential mode only).
        This should match the pin number in the pinctrl configuration.
